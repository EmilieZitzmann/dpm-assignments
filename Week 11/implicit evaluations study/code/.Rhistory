plot_layout(ncol=3)) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +  #Add overall title
theme(plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 5)), #Adjust distance between                                                                                     title and plots
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))#Adjust distances from border to                      plots/title and remove outline
final_plot_extroversion <- plot_extroversion + theme(legend.position = "none") + labs(title = "")
final_plot_neuroticism <- plot_neuroticism + theme(legend.position = "none")  + labs(title = "")
final_plot_agreeable <- plot_agreeable + theme(legend.position = "none")  + labs(title = "")
final_plot_openness <- plot_openness + theme(legend.position = "none") + labs(title = "")
# Arrange the facet plots in a grid
combined_plot <- grid.arrange(final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
plot_layout(ncol=3)) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +  #Add overall title
theme(plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 5)), #Adjust distance between                                                                                     title and plots
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))#Adjust distances from border to                      plots/title and remove outline
# Assuming you have loaded the necessary packages
library(patchwork)
# Arrange the facet plots in a grid
combined_plot <- grid.arrange(final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
plot_layout(ncol=3)) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +  #Add overall title
theme(plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 5)), #Adjust distance between                                                                                     title and plots
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))#Adjust distances from border to                      plots/title and remove outline
# Combine the plots and add the title
combined_plot <- (
final_plot_extroversion +
final_plot_agreeable +
final_plot_conscient +
final_plot_neuroticism +
final_plot_openness +
plot_layout(ncol = 3)) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 5)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))
# Combine the plots and add the title
combined_plot <- (
final_plot_extroversion +
final_plot_agreeable +
final_plot_conscient +
final_plot_neuroticism +
final_plot_openness +
plot_layout(ncol = 3)) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 5)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))
#Show the plot
combined_plot
# Assuming you have loaded the necessary packages
library(cowplot)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",  # Align plots vertically
axis = "l",   # Align plots by the left axis
labels = "AUTO"  # Automatically generate labels
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),  # Adjusting margin to increase space
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Show the plot
print(combined_plot)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",  # Align plots vertically
axis = "l",   # Align plots by the left axis
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),  # Adjusting margin to increase space
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",  # Align plots vertically
axis = "l",   # Align plots by the left axis
labels = "AUTO" ,
remove = T # Automatically generate labels
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),  # Adjusting margin to increase space
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Show the plot
print(combined_plot)
# Assuming you have loaded the necessary packages
library(cowplot)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = "AUTO"
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Show the plot
print(combined_plot)
# Assuming you have loaded the necessary packages
library(patchwork)
# Combine the plots and add the title
combined_plot <- (
final_plot_extroversion +
final_plot_agreeable +
final_plot_conscient +
final_plot_neuroticism +
final_plot_openness +
plot_layout(ncol = 3, guides = 'collect')
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
panel.background = element_rect(fill = "white", color = NA)
)
# Remove strip labels
combined_plot <- combined_plot + theme(strip.text = element_blank(), strip.background = element_blank())
# Show the plot
print(combined_plot)
# Combine the plots and add the title
combined_plot <- (
final_plot_extroversion +
final_plot_agreeable +
final_plot_conscient +
final_plot_neuroticism +
final_plot_openness +
plot_layout(ncol = 2, guides = 'collect')
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
panel.background = element_rect(fill = "white", color = NA)
)
# Remove strip labels
combined_plot <- combined_plot + theme(strip.text = element_blank(), strip.background = element_blank())
# Show the plot
print(combined_plot)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Show the plot
print(combined_plot)
ggsave("combined_plot_Final_Assignment.png", combined_plot, width = 10, height = 8, units = "in", dpi = 600)
ggsave("combined_plot_Final_Assignment.pdf", combined_plot, width = 15, height = 5, units = "in", dpi = 600)
ggsave("combined_plot_Final_Assignment.png")
ggsave("combined_plot_Final_Assignment.png")
ggsave("combined_plot_Final_Assignment.pdf")
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 2,
align = "v",
axis = "l",
labels = c("", "", "", "", "")
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
# Show the plot
print(combined_plot)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")
) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA)
)
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path "../communications")
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path "../../communications")
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path "../communications")
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications")
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications")
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))
# Show the plot
print(combined_plot)
# Save as PNG
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Save as PDF
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Explicitly specify the title as otherwhise it is gone
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8, title = "Regression Analysis: BFI Subscale Scores Predicting IAT Scores")
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8)
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))
# Show the plot
print(combined_plot)
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8)
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications", width = 12, height = 8)
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20)),
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = NA))
# Save as PNG with title
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20, t = 10)),  # Adjust margin for title
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = "white"))  # Set white background
# Save as PNG with title and white background
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8)
# Combine the plots and add the title
combined_plot <- plot_grid(
final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(
strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5, size = 16, margin = margin(b = 20, t = 10, unit = "pt")),  # Adjust margin for title
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = "white")
)
# Save as PNG with title and white background
ggsave(
filename = "combined_plot_Final_Assignment.png",
plot = combined_plot,
path = "../communications",
width = 12,
height = 8,
bg = "white"  # Set the background explicitly to white
)
#Remove all legends and titles
final_plot_extroversion <- plot_extroversion + theme(legend.position = "none") + labs(title = "")
final_plot_conscient <- plot_conscient + theme(legend.position = "none")  + labs(title = "")
final_plot_neuroticism <- plot_neuroticism + theme(legend.position = "none")  + labs(title = "")
final_plot_agreeable <- plot_agreeable + theme(legend.position = "none")  + labs(title = "")
final_plot_openness <- plot_openness + theme(legend.position = "none") + labs(title = "")
# Combine the plots and add the title
combined_plot <- plot_grid(final_plot_extroversion,
final_plot_agreeable,
final_plot_conscient,
final_plot_neuroticism,
final_plot_openness,
ncol = 3,
align = "v",
axis = "l",
labels = c("", "", "", "", "")) +
ggtitle("Regression Analysis: BFI Subscale Scores Predicting IAT Scores") +
theme(strip.background = element_blank(),  # Remove strip labels
plot.title = element_text(hjust = 0.5,
size = 16,
margin = margin(b = 20,
t = 10,
unit = "pt")),  # Adjust margin for the title
plot.margin = margin(40, 40, 40, 40),
panel.background = element_rect(fill = "white", color = "white"))
# Show the plot
print(combined_plot)
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8, bg = "white") #Set the background for the title as otherwhise it goes black
ggsave(filename = "combined_plot_Final_Assignment.png", plot = combined_plot, path = "../communications", width = 12, height = 8, bg = "white") #Set the background for the title as otherwhise it goes black
ggsave(filename = "combined_plot_Final_Assignment.pdf", plot = combined_plot, path = "../communications", width = 12, height = 8)
plot_openness <-  ggplot(data_extreme_scores,
aes(y = D,
x = mean_openness,
color = extreme_score_IAT)) +
geom_jitter(aes(shape = extreme_score_IAT), #add different shapes for IAT extreme Scores
alpha = 0.7,
width = 0.2,
size = 2.5) +
geom_smooth(formula = y ~ x,
method = "lm",
color = "#34495e",
size = 0.8) +
scale_color_manual(values = c("Normal" = "#2196F3",
"Extreme" = "#673AB7"), #values and colors for legend
guide = guide_legend(title = "IAT Score Type")) + #title for legend
scale_shape_manual(values = c("Normal" = 16, "Extreme" = 17),
guide = guide_legend(title = "IAT Score Type")) + #shape for legend
ylab("D Score") +
xlab("Openness") +
ggtitle("Regression Analysis: Openness Predicting IAT Scores") +
theme_minimal() +
scale_x_continuous(breaks = seq(1, 6, 1), limits = c(1, 6)) + #breaks and limits for x-axis
scale_y_continuous(breaks = seq(-2, 2, 1), limits = c(-2, 2)) + #breaks and limits for y-axis
theme(panel.grid.minor = element_blank(), #plot appearance
axis.title.x = element_text(size = 12, face = "bold", margin = margin(t=15), hjust = 0.5),
axis.title.y = element_text(size = 12, face = "bold"),
axis.text = element_text(size = 10),
legend.box.background = element_rect(color = "black", size = 0.5),
plot.title = element_text(hjust = 0.5, size = 14, margin = margin(b = 20, t = 15)))
#Look at plot
plot_openness
View(data_processed)
data_processed |>
distinct(unique_id)
data_processed |>
distinct(unique_id) |>
count(name = "n") |>
kable() |>
add_header_above(header = c( "Sample before exclusions" = 1)) |>
kable_classic(full_width = FALSE)
data_processed |>
distinct(unique_id) |>
count(name = "n") |>
kable() |>
add_header_above(header = c( "Sample before exclusions" = 1)) |>
kable_classic(full_width = FALSE)
data_processed %>%
distinct(unique_id, .keep_all = TRUE) %>%
summarise(n = n_distinct(unique_id)) %>%
kable() %>%
add_header_above(header = c("Sample before exclusions" = 1)) %>%
kable_classic(full_width = FALSE)
View(data_processed)
View(data_processed_after_exclusions)
View(data_processed)
View(data_processed_before_exclusions)
View(data_combined_exclusion)
#Extroversion
data_extroversion_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_e = ifelse(all(!is.na(c_across(contains("bfi_e")))), "include", "exclude")) |>
filter(completed_q_e != "exclude")
#Conscientiousness
data_conscient_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_c = ifelse(all(!is.na(c_across(contains("bfi_c")))), "include", "exclude")) |>
filter(completed_q_c != "exclude")
View(data_extroversion_exclusion)
#Extroversion
data_extroversion_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_e = ifelse(all(!is.na(c_across(contains("bfi_e")))), "include", "exclude")) |>
filter(completed_q_e != "exclude")
#Conscientiousness
data_conscient_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_c = ifelse(all(!is.na(c_across(contains("bfi_c")))), "include", "exclude")) |>
filter(completed_q_c != "exclude")
#Neuroticism
data_neuroticism_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_n = ifelse(all(!is.na(c_across(contains("bfi_n")))), "include", "exclude")) |>
filter(completed_q_n != "exclude")
#Agreeableness
data_agreeable_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_a = ifelse(all(!is.na(c_across(contains("bfi_a")))), "include", "exclude")) |>
filter(completed_q_a != "exclude")
#Openness
data_openness_exclusion <- data_reversed_items |>
rowwise() |>
mutate(completed_q_o = ifelse(all(!is.na(c_across(contains("bfi_o")))), "include", "exclude")) |>
filter(completed_q_o != "exclude")
data_combined_exclusion <- data_reversed_items |>
select(unique_id) |>
left_join(data_extroversion_exclusion |>
select(unique_id, completed_q_e), by = "unique_id") |>
left_join(data_conscient_exclusion |>
select(unique_id, completed_q_c), by = "unique_id") |>
left_join(data_neuroticism_exclusion |>
select(unique_id, completed_q_n), by = "unique_id") |>
left_join(data_agreeable_exclusion |>
select(unique_id, completed_q_a), by = "unique_id") |>
left_join(data_openness_exclusion |>
select(unique_id, completed_q_o), by = "unique_id") |>
rowwise() |>
mutate(completed_questionnaires = sum(!is.na(c(completed_q_e,
completed_q_c,
completed_q_n,
completed_q_a,
completed_q_o))),
bfi_questionnaire_inclusion = case_when(completed_questionnaires >= 2 ~
"include",
TRUE ~ "exclude"))
data_completed_exclusion <- data_reversed_items |>
left_join(data_combined_exclusion, by = "unique_id") |>
select(unique_id, bfi_questionnaire_inclusion)
View(data_combined_exclusion)
View(data_completed_exclusion)
---
title: "Examining the relationship between the big-5 personality facets and implicit racial attitudes"
